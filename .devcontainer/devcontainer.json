{
    "name": "Azure SRE rover",

    // Container user to use in VSCode Online and GitHub Codespaces
    "image": "mcr.microsoft.com/devcontainers/base:jammy",
    "remoteUser": "vscode",

    // Volume mounts for the container.
    "mounts": [
        "source=volume-caf-vscode,target=/home/vscode",
        "source=volume-caf-vscode-bashhistory,target=/commandhistory",
        "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind",
        "source=${localEnv:HOME}${localEnv:USERPROFILE}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached"
    ],

    // Run args for the container.
    "runArgs": [
        "--cap-add=SYS_PTRACE",
        "--security-opt",
        "seccomp=unconfined",
        "--init",
        "--network=host"
      ],

    // Adding features to the container.
    "features": {
        "ghcr.io/azure/azure-dev/azd:latest": {},
        "ghcr.io/devcontainers/features/azure-cli:1": {},
        "ghcr.io/devcontainers-contrib/features/act:1": {},
        "ghcr.io/devcontainers/features/github-cli:1": {},
        "ghcr.io/devcontainers-contrib/features/zsh-plugins:0": {
            "plugins": [
                "aliases syntax-highlighting autosuggestions"
            ],
            "username": [
                "vscode"
            ]
        }
    },

    // Workspace mounts and environment variables can be added here.
    "workspaceMount": "source=${localWorkspaceFolder},target=/tf/caf,type=bind",
    "workspaceFolder": "/tf/caf",


    // Uncomment the next line to run commands after the container is created.
	// "postCreateCommand" : "sudo chmod 400 ~/.ssh/* && git config --global core.editor vi && echo 'export PATH=$HOME/.tfenv/tfenv-3.0.0/bin:$PATH' >> ~/.zshrc",
    "postCreateCommand": "sudo cp -R /tmp/.ssh-localhost/* ~/.ssh && sudo chown -R $(whoami):$(whoami) /tf/caf ~/.ssh && sudo chmod 400 ~/.ssh/* && git config --global core.editor vi && pre-commit install && pre-commit autoupdate",
    "postStartCommand": "sudo chmod 666 /var/run/docker.sock",
    // "postCreateCommand": "sudo cp -R /tmp/.ssh-localhost/* ~/.ssh && sudo chown -R $(whoami):$(whoami) /tf/caf ~/.ssh && sudo chmod 400 ~/.ssh/* && git config --global core.editor vi && pre-commit install && pre-commit autoupdate",


    // Adding the extensions you in the container.
    "customizations": {
        "vscode": {
            "extensions": [
                "mutantdino.resourcemonitor",
                "eamodio.gitlens",
                "GitHub.copilot"
			]
        }
    }

}
